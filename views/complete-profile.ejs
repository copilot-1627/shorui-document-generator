<div class="min-h-screen bg-gray-50 py-12">
    <div class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-8">
        <div class="text-center mb-8">
            <h1 class="text-2xl font-bold text-gray-900 mb-2">Complete Your Profile</h1>
            <p class="text-gray-600">We need a few more details to set up your account</p>
        </div>
        
        <% if (locals.error) { %>
            <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6">
                <%= error %>
            </div>
        <% } %>
        
        <form action="/complete-profile" method="POST" class="space-y-6">
            <!-- Phone Number -->
            <div>
                <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
                    Phone Number *
                </label>
                <input 
                    type="tel" 
                    id="phone" 
                    name="phone" 
                    required 
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                    placeholder="+918310496175"
                    pattern="^\+[1-9]\d{1,14}$"
                    title="Please enter a valid international phone number starting with + and country code (e.g., +918310496175, +1234567890, +923001234567)"
                >
                <div class="text-xs text-gray-500 mt-1 space-y-1">
                    <p>Include country code. Examples:</p>
                    <p>• India: +91xxxxxxxxxx</p>
                    <p>• Pakistan: +92xxxxxxxxxx</p>
                    <p>• USA: +1xxxxxxxxxx</p>
                    <p>• UK: +44xxxxxxxxxx</p>
                </div>
            </div>
            
            <!-- Display existing info -->
            <div class="bg-gray-50 p-4 rounded-lg">
                <h3 class="text-sm font-medium text-gray-700 mb-2">Account Information</h3>
                <div class="space-y-1 text-sm text-gray-600">
                    <p><span class="font-medium">Name:</span> <%= user.firstName %> <%= user.lastName %></p>
                    <p><span class="font-medium">Email:</span> <%= user.email %></p>
                </div>
            </div>
            
            <button 
                type="submit" 
                class="w-full bg-primary text-white py-3 px-4 rounded-lg font-medium hover:bg-secondary transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"
            >
                Complete Setup
            </button>
        </form>
        
        <div class="text-center mt-6">
            <a href="/auth/logout" class="text-sm text-gray-500 hover:text-gray-700">
                Cancel and logout
            </a>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const phoneInput = document.getElementById('phone');
        
        // Phone number formatting and validation
        phoneInput.addEventListener('input', function(e) {
            let value = e.target.value;
            
            // Remove all non-digit and non-plus characters
            value = value.replace(/[^\d+]/g, '');
            
            // Ensure it starts with + if there are digits
            if (value && !value.startsWith('+')) {
                value = '+' + value;
            }
            
            // Limit total length to 16 characters (+xxx plus up to 12 digits)
            if (value.length > 16) {
                value = value.substring(0, 16);
            }
            
            e.target.value = value;
            
            // Real-time validation feedback
            const isValid = /^\+[1-9]\d{1,14}$/.test(value);
            if (value.length > 3) { // Only show feedback when user has typed something meaningful
                if (isValid) {
                    e.target.classList.remove('border-red-500');
                    e.target.classList.add('border-green-500');
                } else {
                    e.target.classList.remove('border-green-500');
                    e.target.classList.add('border-red-500');
                }
            } else {
                e.target.classList.remove('border-red-500', 'border-green-500');
            }
        });
        
        // Prevent form submission with invalid phone number
        document.querySelector('form').addEventListener('submit', function(e) {
            const phoneValue = phoneInput.value;
            const isValid = /^\+[1-9]\d{1,14}$/.test(phoneValue);
            
            if (!isValid) {
                e.preventDefault();
                alert('Please enter a valid international phone number with country code (e.g., +918310496175)');
                phoneInput.focus();
                return false;
            }
        });
        
        // Auto-focus on phone input
        phoneInput.focus();
    });
</script>